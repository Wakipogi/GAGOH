<!DOCTYPE html>
<html>
<head>
  <title>User Manager</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #111; color: white; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 10px; border: 1px solid #555; }
    .inactive { color: red; }
    .active { color: green; }
  </style>
</head>
<body>
  <h2>Add New User</h2>
  <form action="/add_user" method="POST">
    Username: <input name="username">
    Password: <input name="password">
    Duration (days): <input name="duration" type="number" value="1">
    Device Limit: <input name="limit" type="number" value="1">
    <button type="submit">Add</button>
  </form>

  <h2>User List</h2>
  <table>
    <tr><th>Username</th><th>Status</th><th>Remaining</th><th>Device ID</th></tr>
    {% for u in users %}
    <tr>
      <td>{{ u[1] }}</td>
      <td class="{{ 'inactive' if not u[5] else 'active' }}">{{ 'Inactive' if not u[5] else 'Active' }}</td>
      <td>
        {% if u[5] %}
          {% set expire = (datetime.fromisoformat(u[5]) + timedelta(days=u[3])) %}
          {{ (expire - datetime.utcnow()).days }} days
        {% else %}
          --
        {% endif %}
      </td>
      <td>{{ u[6] or '--' }}</td>
    </tr>
    {% endfor %}
  </table>
</body>
</html>